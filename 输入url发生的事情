输入url发生的事情
在浏览器里输入一个url，发生了什么？
简单版：
1.连接 当我们输入这样一个请求时，首先要建立一个socket连接，因为socket是通过ip和端口建立的，所以之前还有一个DNS解析过程，把www.mycompany.com变成ip，如果url里不包含端口号，则会使用该协议的默认端口号。
DNS的过程是这样的：首先我们知道我们本地的机器上在配置网络时都会填写DNS，这样本机就会把这个url发给这个配置的DNS服务器，如果能够找到相应的url则返回其ip，否则该DNS将继续将该解析请求发送给上级DNS，整个DNS可以看做是一个树状结构，该请求将一直发送到根直到得到结果。现在已经拥有了目标ip和端口号，这样我们就可以打开socket连接了。

2.请求 连接成功建立后，开始向web服务器发送请求，这个请求一般是GET或POST命令（POST用于FORM参数的传递）。GET命令的格式为：　　GET 路径/文件名 HTTP/1.0
文件名指出所访问的文件，HTTP/1.0指出Web浏览器使用的HTTP版本。现在可以发送GET命令：
GET /mydir/index.html HTTP/1.0，

3.应答 web服务器收到这个请求，进行处理。从它的文档空间中搜索子目录mydir的文件index.html。如果找到该文件，Web服务器把该文件内容传送给相应的Web浏览器。
为了告知浏览器，，Web服务器首先传送一些HTTP头信息，然后传送具体内容（即HTTP体信息）

4.关闭连接：当应答结束后，Web浏览器与Web服务器必须断开，以保证其它Web浏览器能够与Web服务器建立连接。

复杂版：
1.本地过程：
若DNS缓存中没有相关数据，则IE浏览器先向DNS服务器发出DNS请求：
这一过程的目的是获取www.sina.com这个域名所对应的IP地址；
IE浏览器向本机DNS模块发出DNS请求，DNS模块生成相关的DNS报文；
DNS模块将生成的DNS报文传递给传输层的UDP协议单元；
UDP协议单元将该数据封装成UDP数据报，传递给网络层的IP协议单元；
IP协议单元将该数据封装成IP数据包，其中目的IP地址为DNS服务器的IP地址；
封装好的IP数据包将传递给数据链路层的协议单元进行发送；
发送时如果ARP缓存中没有相关数据，则发送ARP广播请求，等待ARP回应；
得到ARP回应后，将IP地址与路由下一跳MAC地址对应的信息写入ARP缓存表；
写入缓存后，以路由下一跳地址填充目的MAC地址，并以数据帧形式转发；
这个转发过程可能会进行多次，这取决于DNS服务器在校园网中的位置；
DNS请求被发送到DNS服务器的数据链路层协议单元；
DNS服务器的数据链路层协议单元解析收到的数据帧，将其内部所含有的IP数据包传递给网络层IP协议单元；
DNS服务器的IP协议单元解析收到的IP数据包，将其内部所含有的UDP数据报传递给传输层的UDP协议单元；
DNS服务器的UDP协议单元解析收到的UDP数据包，将其内部所含有的DNS报文传递给该服务器上的DNS服务单元；
DNS服务单元收到DNS请求，将域名解析为对应的IP地址，产生DNS回应报文；
（所有应用层报文必须通过传输层、网络层和数据链路层，因此在下面的叙述中，我将简化这一过程的叙述，简化形式如下面的样子，其中单箭头为本机内部传递，双箭头为网络上的发送）
DNS回应报文→UDP→IP→MAC→→请求域名解析的主机；
请求域名解析的主机收到数据帧，该数据帧→IP→UDP→DNS→IE浏览器；
将域名解析的结果以域名和IP地址对应的形式写入DNS缓存表。

2.IE浏览器与www.sina.com.cn建立TCP连接：TCP建立连接的三次握手
IE浏览器向www.sina.com.cn发出TCP连接请求报文；
该请求TCP报文中的SYN标志位被设置为1，表示连接请求；
该TCP请求报文→IP(DNS)→MAC(ARP)→→校园网关→→www.sina.com.cn主机；
该TCP请求报文经过IP层时，填入的目的IP地址就是上面DNS过程获得的IP地址；
经过数据链路层时，若MAC地址不明，还要进行上面所叙述的ARP过程；
www.sina.com.cn收到的数据帧→IP→TCP，TCP协议单元会回应请求应答报文；
该请求应答TCP报文中的SYN和ACK标志位均被设置为1，表示连接请求应答；
该TCP请求应答报文→IP→MAC(ARP)→→校园网关→→请求主机；
请求主机收到数据帧→IP→TCP，TCP协议单元会回应请求确认报文；
该请求应答TCP报文中的ACK标志位被设置为1，表示连接请求确认；
该TCP请求确认报文→IP→MAC(ARP)→→校园网关→→www.sina.com.cn主机；
www.sina.com.cn收到的数据帧→IP→TCP，连接建立完成；

3.IE浏览器开始HTTP访问过程
IE浏览器向www.sina.com.cn发出HTTP-GET方法报文；
该HTTP-GET方法报文→TCP→IP→MAC→→校园网关→→www.sina.com.cn主机；
www.sina.com.cn收到的数据帧→IP→TCP→HTTP，HTTP协议单元会回应HTTP协议格式封装好的HTML超文本形式数据；
HTTP-HTML数据→TCP→IP→MAC(ARP)→→校园网关→→请求主机；
请求主机收到的数据帧→IP→TCP→HTTP→IE浏览器，浏览器会以网页形式显示HTML超文本，就是我们所看到的网页。

4.断开TCP连接：TCP断开连接的四次握手
IE浏览器向www.sina.com.cn发出TCP连接结束请求报文；
该请求TCP报文中的FIN标志位被设置为1，表示结束请求；
该TCP结束请求报文→IP→MAC(ARP)→→校园网关→→www.sina.com.cn主机；
www.sina.com.cn收到的数据帧→IP→TCP，TCP协议单元会回应结束应答报文；
该结束应答TCP报文中的FIN和ACK标志位均被设置为1，表示结束应答；
该TCP结束应答报文→IP→MAC(ARP)→→校园网关→→请求主机；
这个过程需要双向进行，因此www.sina.com.cn主机也会按上述流程再做一次；
整个过程被称为TCP断开连接的四次握手。